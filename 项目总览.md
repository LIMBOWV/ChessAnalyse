# 📊 Stockfish 国际象棋分析系统 - 项目总览

**项目名称**: Stockfish Chess Analyzer  
**开发周期**: 第1天 - 第6天  
**当前版本**: 0.0.1-SNAPSHOT  
**项目状态**: 核心功能完成 (85%)

---

## 🎯 项目简介

这是一个基于Spring Boot和Vue.js的国际象棋分析系统，集成Stockfish引擎，为棋手提供专业的棋局分析、失误检测、开局研究、数据统计等功能。

---

## 📦 技术架构

### 后端技术栈
```
Spring Boot 3.5.6
├── Spring Data JPA - 数据持久层
├── Hibernate - ORM框架
├── MySQL Connector - 数据库驱动
├── Lombok - 代码简化
├── Jakarta Validation - 数据校验
└── SLF4J + Logback - 日志系统
```

### 前端技术栈
```
Vue.js 3 (CDN)
├── ECharts 5.x - 数据可视化
├── Chessboard.js 1.0 - 棋盘组件
├── Chess.js - 棋局引擎
└── Fetch API - HTTP请求
```

### 开发工具
- **IDE**: IntelliJ IDEA / VS Code
- **构建工具**: Maven 3.9+
- **版本控制**: Git
- **数据库管理**: MySQL Workbench
- **API测试**: cURL / Postman

---

## 📂 项目结构

```
stockfish-analyzer/
├── src/
│   ├── main/
│   │   ├── java/org/example/stockfishanalyzer/
│   │   │   ├── StockfishAnalyzerApplication.java
│   │   │   ├── config/          # 配置类
│   │   │   ├── controller/      # REST控制器 (15个)
│   │   │   ├── dto/             # 数据传输对象 (20+)
│   │   │   ├── entity/          # JPA实体类 (10个)
│   │   │   ├── enums/           # 枚举类型 (5个)
│   │   │   ├── repository/      # 数据访问层 (10个)
│   │   │   ├── service/         # 业务逻辑层 (12个)
│   │   │   └── util/            # 工具类
│   │   └── resources/
│   │       ├── application.properties
│   │       ├── static/          # 前端资源
│   │       │   ├── *.html       # 15个页面
│   │       │   └── vendor/      # 第三方库
│   │       └── templates/
│   └── test/                    # 测试代码
├── pom.xml                      # Maven配置
└── README.md                    # 项目说明
```

---

## 🗄️ 数据库设计

### ER图概览
```
┌─────────────┐       ┌──────────────┐       ┌─────────────────┐
│  tbl_user   │──1:N──│ tbl_game_pgn │──1:N──│ tbl_analysis_   │
│             │       │              │       │    result       │
└─────────────┘       └──────────────┘       └─────────────────┘
                             │
                          1:N│
                             ▼
                      ┌──────────────┐
                      │ tbl_position │
                      │   _bookmark  │
                      └──────────────┘
                             │
                          N:M│
                             ▼
                      ┌──────────────┐
                      │  tbl_game_   │
                      │     tag      │
                      └──────────────┘
```

### 数据表详情

#### 1. tbl_user (用户表)
| 字段 | 类型 | 说明 |
|------|------|------|
| id | BIGINT | 主键 |
| username | VARCHAR(50) | 用户名（唯一） |
| password | VARCHAR(255) | 密码（加密） |
| email | VARCHAR(100) | 邮箱 |
| created_at | DATETIME | 创建时间 |

#### 2. tbl_game_pgn (棋局表)
| 字段 | 类型 | 说明 |
|------|------|------|
| id | BIGINT | 主键 |
| user_id | BIGINT | 用户ID（外键） |
| pgn_content | TEXT | PGN内容 |
| white_player | VARCHAR(100) | 白方棋手 |
| black_player | VARCHAR(100) | 黑方棋手 |
| game_result | VARCHAR(20) | 结果 (1-0/0-1/1/2-1/2) |
| game_date | VARCHAR(50) | 对局日期 |
| analysis_status | ENUM | 分析状态 |
| uploaded_at | DATETIME | 上传时间 |

#### 3. tbl_analysis_result (分析结果表)
| 字段 | 类型 | 说明 |
|------|------|------|
| id | BIGINT | 主键 |
| game_id | BIGINT | 棋局ID（外键） |
| move_number | INT | 步数 |
| move_san | VARCHAR(10) | 走法（SAN格式） |
| score | VARCHAR(20) | 评分 |
| best_move | VARCHAR(10) | 最佳走法 |
| move_classification | ENUM | 走法分类 |

#### 4. tbl_opening_book (开局库表)
| 字段 | 类型 | 说明 |
|------|------|------|
| id | BIGINT | 主键 |
| opening_name | VARCHAR(100) | 开局名称 |
| eco_code | VARCHAR(10) | ECO编码 |
| moves | VARCHAR(500) | 走法序列 |

#### 5. tbl_user_statistics (统计表)
| 字段 | 类型 | 说明 |
|------|------|------|
| id | BIGINT | 主键 |
| user_id | BIGINT | 用户ID |
| total_games | INT | 总棋局数 |
| wins | INT | 胜局数 |
| losses | INT | 败局数 |
| draws | INT | 和局数 |
| avg_accuracy | DECIMAL | 平均精准度 |

#### 6. tbl_task (任务表)
| 字段 | 类型 | 说明 |
|------|------|------|
| id | BIGINT | 主键 |
| user_id | BIGINT | 用户ID |
| title | VARCHAR(200) | 任务标题 |
| description | TEXT | 任务描述 |
| due_date | DATE | 截止日期 |
| priority | ENUM | 优先级 |
| status | ENUM | 状态 |

#### 7. tbl_user_settings (设置表)
| 字段 | 类型 | 说明 |
|------|------|------|
| id | BIGINT | 主键 |
| user_id | BIGINT | 用户ID |
| theme | VARCHAR(20) | 主题 |
| language | VARCHAR(10) | 语言 |
| email_notifications | BOOLEAN | 邮件通知 |

#### 8. tbl_position_bookmark (书签表)
| 字段 | 类型 | 说明 |
|------|------|------|
| id | BIGINT | 主键 |
| user_id | BIGINT | 用户ID |
| game_id | BIGINT | 棋局ID |
| fen_position | VARCHAR(100) | FEN位置 |
| move_number | INT | 步数 |
| note | TEXT | 备注 |

#### 9. tbl_game_tag (标签表)
| 字段 | 类型 | 说明 |
|------|------|------|
| id | BIGINT | 主键 |
| user_id | BIGINT | 用户ID |
| tag_name | VARCHAR(50) | 标签名 |
| tag_color | VARCHAR(20) | 颜色 |

#### 10. tbl_game_tag_relation (标签关联表)
| 字段 | 类型 | 说明 |
|------|------|------|
| id | BIGINT | 主键 |
| tag_id | BIGINT | 标签ID |
| game_id | BIGINT | 棋局ID |

---

## 🚀 核心功能

### 1. 用户系统
- ✅ 用户注册/登录
- ✅ 密码加密存储
- ✅ 会话管理
- ✅ 权限控制

### 2. 棋局管理
- ✅ PGN文件上传
- ✅ 棋局列表展示
- ✅ 棋局详情查看
- ✅ 棋盘可视化
- ✅ 棋局删除

### 3. Stockfish分析
- ✅ 异步引擎分析
- ✅ 多线程并发处理
- ✅ 走法评分
- ✅ 最佳走法推荐
- ✅ 走法分类（妙手/好棋/漏着/失误）

### 4. 失误分析
- ✅ 失误检测与统计
- ✅ 失误类型分类
- ✅ 失误详情展示
- ✅ 改进建议

### 5. 开局分析
- ✅ 开局识别
- ✅ ECO编码匹配
- ✅ 开局统计
- ✅ 开局胜率分析

### 6. 数据统计
- ✅ 用户统计仪表盘
- ✅ ECharts可视化
- ✅ 胜率统计
- ✅ 精准度趋势

### 7. 任务管理 ⭐新增
- ✅ 任务创建/编辑/删除
- ✅ 优先级管理
- ✅ 状态跟踪
- ✅ 截止日期提醒

### 8. 系统设置 ⭐新增
- ✅ 主题切换（浅色/深色/紫色）
- ✅ 多语言支持（中文/英文）
- ✅ 通知配置
- ✅ 引擎参数设置

### 9. 位置书签 ⭐新增
- ✅ 位置收藏
- ✅ FEN位置保存
- ✅ 棋盘预览
- ✅ 笔记添加

### 10. 标签管理 ⭐新增
- ✅ 自定义标签
- ✅ 颜色标识
- ✅ 棋局分类
- ✅ 标签统计

### 11. 棋局对比 ⭐新增
- ✅ 双棋局对比
- ✅ 数据对比展示
- ✅ 评分曲线对比
- ✅ 自然语言结论

### 12. 趋势分析 ⭐新增
- ✅ 时间序列分析
- ✅ 多维度统计
- ✅ 开局偏好分析
- ✅ 雷达图展示

---

## 📊 REST API文档

### 基础URL
```
http://localhost:9090
```

### API端点列表

#### 用户相关
| 方法 | 路径 | 说明 |
|------|------|------|
| POST | /api/users/register | 用户注册 |
| POST | /api/users/login | 用户登录 |
| GET | /api/users/{id} | 获取用户信息 |

#### 棋局相关
| 方法 | 路径 | 说明 |
|------|------|------|
| POST | /api/games/upload | 上传PGN |
| GET | /api/games/list | 获取棋局列表 |
| GET | /api/games/{id} | 获取棋局详情 |
| DELETE | /api/games/{id} | 删除棋局 |
| POST | /api/games/{id}/analyze | 分析棋局 |

#### 分析相关
| 方法 | 路径 | 说明 |
|------|------|------|
| GET | /api/analysis/{gameId} | 获取分析结果 |
| GET | /api/analysis/{gameId}/mistakes | 获取失误列表 |

#### 统计相关
| 方法 | 路径 | 说明 |
|------|------|------|
| GET | /api/statistics/user/{userId} | 用户统计 |
| GET | /api/statistics/openings/{userId} | 开局统计 |

#### 任务相关 ⭐新增
| 方法 | 路径 | 说明 |
|------|------|------|
| POST | /api/tasks | 创建任务 |
| GET | /api/tasks | 获取任务列表 |
| GET | /api/tasks/{id} | 获取任务详情 |
| PUT | /api/tasks/{id} | 更新任务 |
| DELETE | /api/tasks/{id} | 删除任务 |
| GET | /api/tasks/statistics | 任务统计 |

#### 书签相关 ⭐新增
| 方法 | 路径 | 说明 |
|------|------|------|
| POST | /api/bookmarks | 创建书签 |
| GET | /api/bookmarks | 获取书签列表 |
| GET | /api/bookmarks/{id} | 获取书签详情 |
| PUT | /api/bookmarks/{id} | 更新书签 |
| DELETE | /api/bookmarks/{id} | 删除书签 |

#### 标签相关 ⭐新增
| 方法 | 路径 | 说明 |
|------|------|------|
| POST | /api/tags | 创建标签 |
| GET | /api/tags | 获取标签列表 |
| PUT | /api/tags/{id} | 更新标签 |
| DELETE | /api/tags/{id} | 删除标签 |
| POST | /api/tags/{tagId}/games/{gameId} | 添加棋局到标签 |
| DELETE | /api/tags/{tagId}/games/{gameId} | 移除棋局 |

#### 对比相关 ⭐新增
| 方法 | 路径 | 说明 |
|------|------|------|
| GET | /api/comparison | 棋局对比分析 |

#### 趋势相关 ⭐新增
| 方法 | 路径 | 说明 |
|------|------|------|
| GET | /api/trends | 趋势分析 |

---

## 🎨 前端页面

### 页面列表
1. **index.html** - 首页（棋局列表）
2. **dashboard.html** - 统计仪表盘
3. **mistakes.html** - 失误分析页
4. **openings.html** - 开局分析页
5. **tasks.html** - 任务管理页 ⭐
6. **settings.html** - 系统设置页 ⭐
7. **bookmarks.html** - 位置书签页 ⭐
8. **tags.html** - 标签管理页 ⭐
9. **compare.html** - 棋局对比页 ⭐
10. **trends.html** - 趋势分析页 ⭐

### 设计特点
- 🎨 **现代化UI** - 渐变背景、圆角卡片、阴影效果
- 📱 **响应式布局** - 适配桌面/平板/移动设备
- 🌈 **主题切换** - 浅色/深色/紫色主题
- 🌍 **多语言** - 中文/英文切换
- 📊 **数据可视化** - ECharts丰富图表
- ♟️ **棋盘展示** - Chessboard.js交互式棋盘

---

## 📈 项目统计

### 代码量
```
总代码行数: ~13,500 行

后端代码:
- Java源文件: 83个
- 代码行数: ~9,000行

前端代码:
- HTML页面: 15个
- 代码行数: ~4,500行

配置文件:
- pom.xml: ~200行
- application.properties: ~50行
```

### 开发进度
```
第1天: ✅ 项目初始化、基础架构搭建
第2天: ✅ 用户系统、棋局上传
第3天: ✅ Stockfish集成、分析功能
第4天: ✅ 失误分析、开局分析
第5天: ✅ 统计仪表盘、数据可视化
第6天: ✅ 任务/设置/书签/标签/对比/趋势
第7天: ⏳ 测试、优化、部署准备

总进度: 85% (6/7天)
```

---

## 🔧 环境要求

### 开发环境
- **JDK**: 17+
- **Maven**: 3.9+
- **MySQL**: 8.0+
- **Node.js**: 16+ (可选，前端开发)

### 运行环境
- **内存**: 最小2GB
- **磁盘**: 最小500MB
- **网络**: 需要访问Maven仓库

---

## 🚀 快速启动

### 1. 克隆项目
```bash
git clone <repository-url>
cd stockfish-analyzer
```

### 2. 配置数据库
```bash
mysql -u root -p
CREATE DATABASE chess_analyzer;
```

编辑 `src/main/resources/application.properties`:
```properties
spring.datasource.url=jdbc:mysql://localhost:3306/chess_analyzer
spring.datasource.username=your_username
spring.datasource.password=your_password
```

### 3. 编译项目
```bash
./mvnw clean compile
```

### 4. 运行应用
```bash
./mvnw spring-boot:run
```

或打包运行:
```bash
./mvnw package -DskipTests
java -jar target/stockfish-analyzer-0.0.1-SNAPSHOT.jar
```

### 5. 访问应用
```
浏览器打开: http://localhost:9090
```

---

## 📝 开发日志

- [第一天开发报告](./第一天开发报告.md)
- [第二天开发报告](./第二天开发报告.md)
- [第三天开发报告](./第三天开发报告.md)
- [第四天开发报告](./第四天开发报告.md)
- [第六天开发报告](./第六天开发报告.md) ⭐最新

---

## 🎓 学习资源

### 相关技术文档
- [Spring Boot官方文档](https://spring.io/projects/spring-boot)
- [Vue.js官方文档](https://vuejs.org/)
- [ECharts文档](https://echarts.apache.org/)
- [Stockfish引擎](https://stockfishchess.org/)

### 国际象棋资源
- [PGN格式规范](https://www.chessclub.com/help/PGN-spec)
- [FEN格式说明](https://en.wikipedia.org/wiki/Forsyth%E2%80%93Edwards_Notation)
- [ECO开局编码](https://www.chessgames.com/eco.html)

---

## 🤝 贡献指南

欢迎贡献代码！请遵循以下步骤：

1. Fork 本仓库
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启 Pull Request

---

## 📄 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件

---

## 👨‍💻 作者

**David**  
- 📧 Email: your.email@example.com
- 🌐 GitHub: [@yourusername](https://github.com/yourusername)

---

## 🙏 致谢

- Stockfish开发团队
- Vue.js社区
- Spring Boot团队
- 所有开源贡献者

---

**最后更新**: 2025年10月24日  
**项目版本**: 0.0.1-SNAPSHOT  
**文档版本**: 1.0
